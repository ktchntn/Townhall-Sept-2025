<!DOCTYPE html>
<html>
  <head>
    <title>September Town Hall</title>
    <link rel="stylesheet" href="./styles/windows.css" />
	<link rel="stylesheet" href="./styles/pixelated-corners.css" />

    <!-- Google Font -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <!-- <link href="https://fonts.googleapis.com/css2?family=Coral+Pixels&family=Slackey&display=swap" rel="stylesheet"> -->
    <link
      href="https://fonts.googleapis.com/css2?family=Handjet:wght@100..900&family=VT323&display=swap"
      rel="stylesheet"
    />
  </head>
  <body>
    <div class="main">
      <div class="container">
        <div class="folder-container" id="cmvp">
          <div class="icon folder"></div>
          <p>CMVP</p>
        </div>
        <div class="folder-container">
          <div class="icon folder"></div>
          <p>HR</p>
        </div>
        <div class="folder-container">
          <div class="icon folder"></div>
          <p>DE&I</p>
        </div>
        <div class="folder-container">
          <a href="#">
            <div class="icon internet"></div>
            <p>Internet</p>
          </a>
        </div>
        <div class="folder-container">
          <a href="./index.html">
            <div class="icon paint"></div>
            <p>Paint</p>
          </a>
        </div>
        <div class="folder-container">
          <a href="./index.html">
            <div class="icon solitaire"></div>
            <p>Solitaire</p>
          </a>
        </div>
        <div class="folder-container">
          <span id="shoutouts-icon">
            <div class="icon shoutouts"></div>
            <p>Shoutouts Part 2</p>
          </span>
        </div>
      </div>

      <div class="bottom-nav">
        <a href="/index.html">
          <button>
            <img class="cm-logo" src="./assets/90s-CM-Logo.png" />Start
          </button>
        </a>
        <div class="time-container">
          <img class="icon" src="./assets/icons/volume-up.png" />
          <p id="time"></p>
        </div>
      </div>
    </div>
  </body>

  <script>
    function updateClock() {
      const now = new Date();
      const time = now.toLocaleTimeString("en-US", {
        hour: "2-digit",
        minute: "2-digit",
      });
      document.getElementById("time").innerText = `${time}`;
    }

    // Call updateClock initially to display the time immediately
    updateClock();

    // Update the clock every second
    setInterval(updateClock, 1000);
  </script>

  <script type="module">
    import { createMediaPlayer } from "./modules/windows98-media-player.js";
    const videos = [
      { title: "Welcome Video", src: "./assets/videos/placeholder.mp4" },
    ];

    let mediaPlayer = null;

    document.getElementById("cmvp").addEventListener("click", function () {
      if (!mediaPlayer) {
        mediaPlayer = createMediaPlayer({
          videos: videos,
          width: 640,
          height: 480,
          centered: false,
          initialVolume: 1,
        });

        mediaPlayer.onClose(() => {
          mediaPlayer = null;
        });
      }
    });
  </script>
  <script type="module">
    import { createTriviaPopup } from "./modules/nineties-popup.js";
    import { createFireWorks } from "./modules/fireworks.js";
    import { triviaQuestions } from "./data/trivia.js";
    const tq = triviaQuestions[3];

    document.querySelector(".internet").addEventListener("click", () => {
      createTriviaPopup({
        title: "TRIVIA TIME!!",
        triviaQuestion: tq.question,
        triviaAnswers: tq.answers,
        answerIndex: tq.answerIndex,
        onCorrect: () => createFireWorks(),
      });
    });
  </script>
  <script type="module">
    import Clippy from "./modules/clippy.js";
    import shoutoutsData from "./data/shoutouts-2.json";
    import clippyMetaData from "./data/clippy-metadata.json";
    let clippy;

    const { spriteWidth: SPRITE_WIDTH, spriteHeight: SPRITE_HEIGHT } =
      clippyMetaData;

    const vw = Math.max(
      document.documentElement.clientWidth || 0,
      window.innerWidth || 0
    );
    const vh = Math.max(
      document.documentElement.clientHeight || 0,
      window.innerHeight || 0
    );

	const onShoutoutsClick = () => {
      clippy = new Clippy({
        size: 2,
        slides: shoutoutsData.slides,
        startingEmote: "bike-arrive",
        startingPosition: {
          top: vh / 2 - SPRITE_HEIGHT,
          left: vw / 2 - SPRITE_WIDTH,
        },
      });

      const onClippyEndTransition = () => {
        clippy.containerEl.classList.remove("position-transition");
        clippy.containerEl.removeEventListener(
          "transitionend",
          onClippyEndTransition
        );

        setTimeout(() => {
          clippy.showDialogue();
        }, 100);
      };

      const onClippyEnter = () => {
        clippy.containerEl.classList.add("position-transition");
        clippy.containerEl.addEventListener(
          "transitionend",
          onClippyEndTransition
        );

		const left = document.querySelector(".container").clientWidth - 60;
		const top = document.querySelector(".bottom-nav").offsetTop - (SPRITE_HEIGHT * 2) - 20;
        clippy.updatePosition({ left, top });

        clippy.spriteSheetEl.removeEventListener("animationend", onClippyEnter);
      };

      clippy.spriteSheetEl.addEventListener("animationend", onClippyEnter);
	  shoutoutsBtn.removeEventListener("click", onShoutoutsClick);
    }

    const shoutoutsBtn = document.getElementById("shoutouts-icon");
    shoutoutsBtn.addEventListener("click", onShoutoutsClick);
  </script>
</html>
